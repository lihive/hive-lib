"use strict";(()=>{var U=class extends Error{constructor(t,r){super(`Tiles (${t.q},${t.r}) and (${r.q},${r.r}) are not adjacent.`)}},j=class extends Error{constructor(t){super(`Expected there to be a tile located at (${t.q}, ${t.r})`)}},L=class extends Error{constructor(t){super(`${t} is not a valid direction.`)}},A=class extends Error{constructor(t){super(`No tile at (${t.q}, ${t.r})`)}};var v=Math.sqrt(3),we=Math.PI,Bt={tileset:{A:3,B:2,G:3,S:2,Q:1}},Gt={id:"pointy-top",f0:v,f1:v/2,f2:0,f3:3/2,b0:v/3,b1:-1/3,b2:0,b3:2/3,startAngle:30},Tt={id:"flat-top",f0:3/2,f1:0,f2:v/2,f3:v,b0:2/3,b1:0,b2:-1/3,b3:v/3,startAngle:0};function wt(e,t){let r=(v/3*e.x-.3333333333333333*e.y)/t,n=2/3*e.y/t,o=-r-n,i=Math.round(r),a=Math.round(n),s=Math.round(o),c=Math.abs(i-r),u=Math.abs(a-n),f=Math.abs(s-o);return c>u&&c>f?i=-a-s:u>f&&(a=-i-s),{q:i,r:a}}function l(e){return`${e.q}.${e.r}`}function It(e,t){return Math.abs(e.q-t.q)<=1&&Math.abs(e.r-t.r)<=1}function B(e,t){return!e||!t?!1:e.q===t.q&&e.r===t.r}function kt(e){return 2*e}function Xe(e,t,r){let{q:n,r:o}=e,i=r;return{x:t*(i.f0*n+i.f1*o),y:t*(i.f2*n+i.f3*o)}}function bt(e,t,r){let{x:n,y:o}=Xe(e,t,r);return`translate(${n} ${o}) rotate(${r.startAngle})`}function Et(e){return v*e}function H(e,t){return e.findIndex(r=>B(t,r))!==-1}function Ot(e){let t=e.split(".");return{q:+t[0],r:+t[1]}}function g(e,t){let{q:r,r:n}=e;switch(t){case 0:return e;case 1:return{q:r+1,r:n-1};case 2:return{q:r+1,r:n};case 3:return{q:r,r:n+1};case 4:return{q:r-1,r:n+1};case 5:return{q:r-1,r:n};case 6:return{q:r,r:n-1};default:throw new L(t)}}function Ie(e,t){let r=t.q-e.q,n=t.r-e.r;if(r===-1){if(n===0)return 5;if(n===1)return 4}if(r===0){if(n===-1)return 6;if(n===1)return 3}if(r===1){if(n===-1)return 1;if(n===0)return 2}throw new U(e,t)}function pe(e){for(;e<1;)e+=6;return 1+(e-1)%6}function ke(e,t){return`${e}${t}`}function G(e){return e[1]}function I(e){return e[0]}function Nt(e,t){return I(e)===t}function F(e,t){if(d(e,t))return[];let r=[];return z(e,t,n=>{r.push(n)}),h(e,t,n=>{r.push(n)}),T(e,t,n=>{r.push(n)}),r}function V(e,t){if(d(e,t))return[];let r=[];return k(n=>{let o=g(t,n),i=o;for(;be(e,i);)i=g(i,n);B(i,o)||r.push(i)}),r}function W(e,t){if(d(e,t))return[];let r=[],n=new Set,o=(i,a)=>{let s=a[a.length-1];a.length===1&&z(i,s,c=>{o(C(i,s,c),[...a,c])}),a.length===2&&(h(i,s,c=>{H(a,c)||o(C(i,s,c),[...a,c])}),z(i,s,c=>{H(a,c)||o(C(i,s,c),[...a,c])}),T(i,s,(c,u)=>{u.length>0&&!H(a,c)&&o(C(i,s,c),[...a,c])})),a.length===3&&T(i,s,(c,u)=>{u.length===0&&!H(a,c)&&!n.has(l(c))&&(r.push(c),n.add(l(c)))})};return o(e,[t]),r}function J(e,t){if(d(e,t))return[];let r=[];return h(e,t,n=>{r.push(n)}),r}function X(e,t){if(d(e,t))return[];let r=[],n=new Set,o=(i,a)=>{let s=a[a.length-1];h(i,s,c=>{if(!H(a,c))if(a.length===3){let u=l(c);n.has(u)||(n.add(u),r.push(c))}else o(C(i,s,c),[...a,c])})};return o(e,[t]),r}function Y(e,t){if(d(e,t))return[];let r=[];return h(e,t,n=>{r.push(n)}),r}function Ee(e,t,r){if(d(e,t))return[];let n=[],o=Ie(t,r);return x(e,t)>1||q(e,t,o)?[]:(e=C(e,t,r),T(e,r,i=>{B(t,i)||n.push(i)}),n)}function Oe(e,t){if(d(e,t))return[];if(x(e,t)>1)return F(e,t);let n=new Set;b(e,t,(s,c)=>{let u=G(c[c.length-1]);n.add(u)});let o=[],i=new Set,a=s=>{s.forEach(c=>{let u=l(c);i.has(u)||(i.add(u),o.push(c))})};return n.forEach(s=>{switch(s){case"A":a(Z(e,t));break;case"B":a(F(e,t));break;case"G":a(V(e,t));break;case"L":a(W(e,t));break;case"P":a(Y(e,t));break;case"Q":a(J(e,t));break;case"S":a(X(e,t));break}}),o}function wr(){return{pass:!0}}function Ir(e,t){return{tileId:e,to:t}}function kr(e,t){return{from:e,to:t}}function br(e){return e.length%2?"b":"w"}function ee(e){return"pass"in e&&e.pass}function te(e){return"tileId"in e&&"to"in e}function re(e){return"from"in e&&"to"in e}function d(e,t){if(x(e,t)>1)return!1;let r=he(e,t).at(0);if(!r)return!1;let n=De(e,r,t),o=me(e);return n.length!==o.length-1}function Er(e,t,r){let n=$(e,r);if(!n)return[];let o=I(n),i=G(n),a=[];if(i==="X")return a;if(o===t)switch(i){case"A":a=Z(e,r);break;case"B":a=F(e,r);break;case"G":a=V(e,r);break;case"L":a=W(e,r);break;case"M":a=Oe(e,r);break;case"P":a=Y(e,r);break;case"Q":a=J(e,r);break;case"S":a=X(e,r);break}let s=[];if(b(e,r,(c,u)=>{let f=u[u.length-1];G(f)==="P"&&I(f)===t&&s.push(c)}),s.length){let c=new Set(a.map(l)),u=f=>{f.forEach(N=>{let Se=l(N);c.has(Se)||(c.add(Se),a.push(N))})};s.forEach(f=>{u(Ee(e,r,f))})}return a}var $e=Symbol.for("immer-nothing"),Ne=Symbol.for("immer-draftable"),p=Symbol.for("immer-state");function _(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var E=Object.getPrototypeOf;function O(e){return!!e&&!!e[p]}function P(e){return e?Re(e)||Array.isArray(e)||!!e[Ne]||!!e.constructor?.[Ne]||se(e)||ce(e):!1}var Ye=Object.prototype.constructor.toString();function Re(e){if(!e||typeof e!="object")return!1;let t=E(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Ye}function ne(e,t){ae(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function ae(e){let t=e[p];return t?t.type_:Array.isArray(e)?1:se(e)?2:ce(e)?3:0}function Ce(e,t){return ae(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Qe(e,t,r){let n=ae(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Ze(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function se(e){return e instanceof Map}function ce(e){return e instanceof Set}function M(e){return e.copy_||e.base_}function _e(e,t){if(se(e))return new Map(e);if(ce(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&Re(e))return E(e)?{...e}:Object.assign(Object.create(null),e);let r=Object.getOwnPropertyDescriptors(e);delete r[p];let n=Reflect.ownKeys(r);for(let o=0;o<n.length;o++){let i=n[o],a=r[i];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(E(e),r)}function Ge(e,t=!1){return ue(e)||O(e)||!P(e)||(ae(e)>1&&(e.set=e.add=e.clear=e.delete=et),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>Ge(n,!0))),e}function et(){_(2)}function ue(e){return Object.isFrozen(e)}var tt={};function S(e){let t=tt[e];return t||_(0,e),t}var R;function Ke(){return R}function rt(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ae(e,t){t&&(S("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ye(e){ve(e),e.drafts_.forEach(nt),e.drafts_=null}function ve(e){e===R&&(R=e.parent_)}function Fe(e){return R=rt(R,e)}function nt(e){let t=e[p];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function ze(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[p].modified_&&(ye(t),_(4)),P(e)&&(e=oe(t,e),t.parent_||ie(t,e)),t.patches_&&S("Patches").generateReplacementPatches_(r[p].base_,e,t.patches_,t.inversePatches_)):e=oe(t,r,[]),ye(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==$e?e:void 0}function oe(e,t,r){if(ue(t))return t;let n=t[p];if(!n)return ne(t,(o,i)=>qe(e,n,t,o,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return ie(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let o=n.copy_,i=o,a=!1;n.type_===3&&(i=new Set(o),o.clear(),a=!0),ne(i,(s,c)=>qe(e,n,o,s,c,r,a)),ie(e,o,!1),r&&e.patches_&&S("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function qe(e,t,r,n,o,i,a){if(O(o)){let s=i&&t&&t.type_!==3&&!Ce(t.assigned_,n)?i.concat(n):void 0,c=oe(e,o,s);if(Qe(r,n,c),O(c))e.canAutoFreeze_=!1;else return}else a&&r.add(o);if(P(o)&&!ue(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;oe(e,o),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&ie(e,o)}}function ie(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Ge(t,r)}function ot(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Ke(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},o=n,i=Te;r&&(o=[n],i=Q);let{revoke:a,proxy:s}=Proxy.revocable(o,i);return n.draft_=s,n.revoke_=a,s}var Te={get(e,t){if(t===p)return e;let r=M(e);if(!Ce(r,t))return it(e,r,t);let n=r[t];return e.finalized_||!P(n)?n:n===xe(e.base_,t)?(ge(e),e.copy_[t]=Be(n,e)):n},has(e,t){return t in M(e)},ownKeys(e){return Reflect.ownKeys(M(e))},set(e,t,r){let n=Ue(M(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let o=xe(M(e),t),i=o?.[p];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Ze(r,o)&&(r!==void 0||Ce(e.base_,t)))return!0;ge(e),He(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return xe(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,ge(e),He(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=M(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){_(11)},getPrototypeOf(e){return E(e.base_)},setPrototypeOf(){_(12)}},Q={};ne(Te,(e,t)=>{Q[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Q.deleteProperty=function(e,t){return Q.set.call(this,e,t,void 0)};Q.set=function(e,t,r){return Te.set.call(this,e[0],t,r,e[0])};function xe(e,t){let r=e[p];return(r?M(r):e)[t]}function it(e,t,r){let n=Ue(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function Ue(e,t){if(!(t in e))return;let r=E(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=E(r)}}function He(e){e.modified_||(e.modified_=!0,e.parent_&&He(e.parent_))}function ge(e){e.copy_||(e.copy_=_e(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var at=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let i=r;r=t;let a=this;return function(c=i,...u){return a.produce(c,f=>r.call(this,f,...u))}}typeof r!="function"&&_(6),n!==void 0&&typeof n!="function"&&_(7);let o;if(P(t)){let i=Fe(this),a=Be(t,void 0),s=!0;try{o=r(a),s=!1}finally{s?ye(i):ve(i)}return Ae(i,n),ze(o,i)}else if(!t||typeof t!="object"){if(o=r(t),o===void 0&&(o=t),o===$e&&(o=void 0),this.autoFreeze_&&Ge(o,!0),n){let i=[],a=[];S("Patches").generateReplacementPatches_(t,o,i,a),n(i,a)}return o}else _(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(a,...s)=>this.produceWithPatches(a,c=>t(c,...s));let n,o;return[this.produce(t,r,(a,s)=>{n=a,o=s}),n,o]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){P(e)||_(8),O(e)&&(e=st(e));let t=Fe(this),r=Be(e,void 0);return r[p].isManual_=!0,ve(t),r}finishDraft(e,t){let r=e&&e[p];(!r||!r.isManual_)&&_(9);let{scope_:n}=r;return Ae(n,t),ze(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let o=t[r];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}r>-1&&(t=t.slice(r+1));let n=S("Patches").applyPatches_;return O(e)?n(e,t):this.produce(e,o=>n(o,t))}};function Be(e,t){let r=se(e)?S("MapSet").proxyMap_(e,t):ce(e)?S("MapSet").proxySet_(e,t):ot(e,t);return(t?t.scope_:Ke()).drafts_.push(r),r}function st(e){return O(e)||_(10,e),je(e)}function je(e){if(!P(e)||ue(e))return e;let t=e[p],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=_e(e,t.scope_.immer_.useStrictShallowCopy_)}else r=_e(e,!0);return ne(r,(n,o)=>{Qe(r,n,je(o))}),t&&(t.finalized_=!1),r}var m=new at,fe=m.produce,Dr=m.produceWithPatches.bind(m),Nr=m.setAutoFreeze.bind(m),Ar=m.setUseStrictShallowCopy.bind(m),Fr=m.applyPatches.bind(m),zr=m.createDraft.bind(m),qr=m.finishDraft.bind(m);function Vr(e,t,r){let n=0,o=`${t}Q`;return Le(e,o).forEach(a=>{y(e,a).forEach(s=>{s===o&&(n+=1)})}),n===r.tileset.Q}function Wr(e,t){return Le(e,`${t}Q`).every(n=>ct(e,n,(o,i)=>i.length>0))}function Jr(...e){return t=>e.reduce((r,n)=>n(r),t)}function z(e,t,r){let n=x(e,t);return n?k(o=>{let i=g(t,o),a=y(e,i);return a.length>=n&&!q(e,t,o)?r(i,a,o):!0}):!0}function k(e){for(let t=1;t<=6;++t)if(e(t)==!1)return!1;return!0}function T(e,t,r){let n=x(e,t);return n?k(o=>{let i=g(t,o),a=y(e,i);return n-a.length>=2&&!q(e,t,o)?r(i,a,o):!0}):!0}function D(e,t,r){return k(n=>{let o=g(t,n);return r(o,y(e,o),n)!==!1})}function b(e,t,r){return k(n=>{let o=g(t,n),i=y(e,o);return i.length?r(o,i)!==!1:!0})}function h(e,t,r){let n=y(e,t),o=he(e,t),i=a=>H(o,a);return n?D(e,t,(a,s,c)=>n.length-s.length===1&&!q(e,t,c)&&(n.length>1||dt(e,a,i))?r(a,s,c):!0):!0}function w(e,t){for(let r in e)for(let n in e[r]){let o=e[r][n];if(t({q:+r,r:+n},o)===!1)return!1}return!0}function Xr(e,t){let r=new Set;return w(e,n=>D(e,n,(o,i)=>{let a=l(o);return!r.has(a)&&!i.length?(r.add(a),t(o,i)!==!1):!0}))}function ct(e,t,r){return D(e,t,(n,o)=>r(n,o)===!0)}function Yr(e,t,r){let n;return D(e,t,(o,i)=>r(o,i)?(n=o,!1):!0),n}function Le(e,t){let r=[];return w(e,(n,o)=>{o.includes(t)&&r.push(n)}),r}function Zr(e,t){let r={};return t=t??e.length,e.slice(0,t).forEach(n=>{ee(n)||(te(n)&&le(r,n.tileId,n.to),re(n)&&Me(r,n.from,n.to))}),r}function en(e,t,r){let n=0;return w(e,(o,i)=>{!t&&!r?n+=i.length:i.forEach(a=>{let s=t!==void 0?I(a)===t:!0,c=r!==void 0?G(a)===r:!0;s&&c&&(n+=1)})}),n}function me(e){let t=[];return w(e,r=>t.push(r)),t}function he(e,t){let r=[];return b(e,t,n=>{r.push(n)}),r}function y(e,t){let{q:r,r:n}=t,o=e[r];return o?o[n]??[]:[]}function tn(e,t){let r=[];return w(e,(n,o)=>r.push({coordinate:n,tiles:o})),t&&lt(r),r}function x(e,t){return y(e,t).length}function $(e,t){return y(e,t).at(-1)}function rn(e){let t=[];return w(e,(r,n)=>t.push(...n)),t}function Ve(e){let t=[];return w(e,(r,n)=>t.push(...n)),t}function nn(e){let t=new Set,r=[];return me(e).forEach(n=>{D(e,n,(o,i)=>{let a=l(o);!i.length&&!t.has(a)&&(t.add(a),r.push(o))})}),r}function on(e){return Object.keys(e).length===0}function q(e,t,r){let n=pe(r-1),o=pe(r+1),i=g(t,r),a=g(t,n),s=g(t,o),c=x(e,t),u=x(e,i),f=x(e,a),N=x(e,s);return c<=f&&c<=N&&u<f&&u<N}function be(e,t){return y(e,t).length>0}function C(e,t,r){return fe(e,n=>{Me(n,t,r)})}function Me(e,t,r){let n=$(e,t);if(!n)throw new A(t);return le(Pe(e,t),n,r)}function an(e,t,r){let n=structuredClone(e);return Me(n,t,r)}function sn(e,t,r){return fe(e,n=>{le(n,t,r)})}function le(e,t,r){let{q:n,r:o}=r;return n in e||(e[n]={}),o in e[n]||(e[n][o]=[]),e[n][o].push(t),e}function ut(e,t,r){if(arguments.length===2)return o=>ut(o,e,t);let n=structuredClone(e);return le(n,t,r)}function cn(e,t){return fe(e,r=>Pe(r,t))}function Pe(e,t){let{q:r,r:n}=t,o=e[r]?.[n]||[];if(!o.pop())throw new A(t);return o.length===0&&delete e[r][n],Object.keys(e[r]).length===0&&delete e[r],e}function ft(e,t){if(arguments.length===1)return n=>ft(n,e);let r=structuredClone(e);return Pe(r,t)}function lt(e){return e.slice().sort((t,r)=>{let n=r.coordinate.r-t.coordinate.r;return n<0?1:n===0?t.tiles.length-r.tiles.length:-1})}function dt(e,t,r){return!D(e,t,(n,o,i)=>!r(n,o,i))}function De(e,t,r){let n=new Set,o=[],i=s=>{n.add(l(s)),o.push(s),b(e,s,c=>{!B(r,c)&&!n.has(l(c))&&i(c)})};return y(e,t).length&&!B(t,r)&&i(t),o}function Z(e,t){if(d(e,t))return[];let r=[],n=new Set([l(t)]),o=(i,a)=>{h(i,a,s=>{let c=l(s);if(!n.has(c)){if(!$(i,a))throw new j(a);n.add(c),r.push(s),o(C(i,a,s),s)}})};return o(e,t),r}function gn(e,t,r){let o=pt(e,t,r).reduce((i,a)=>(i[a]=i[a]??[],i[a].push(a),i),{});return Object.values(o)}function pt(e,t,r){let n=[],o={};Ve(e).forEach(a=>{o[a]=(o[a]||0)+1});let i;for(i in r.tileset){let a=ke(t,i),s=r.tileset[i]||0,c=o[a]||0,u=Math.max(0,s-c),f=Array.from({length:u},()=>a);n.push(...f)}return n}var de=".",K="~";function yn(e){let t=JSON.stringify(e);if(t==="{}")return K+de;let r="";for(let n of t)switch(n){case"{":r+=de;break;case"}":r+=K;break;case'"':case",":case":":case"[":case"]":case"w":break;default:r+=n}return r=K+r.slice(1,-2),r}function vn(e){return e.map(t=>ee(t)?ht():te(t)?xt(t.tileId,t.to):re(t)?mt(t.from,t.to):"").join()}function mt(e,t){return`(${e.q},${e.r})(${t.q},${t.r})`}function Hn(e){let t=e[Symbol.iterator](),r={};if(e===K+de)return r;let n,o,i=t.next(),a=(u=!1)=>{u&&(i=t.next());let f="";for(;!i.done&&c(i.value);)f+=i.value,i=t.next();return+f},s=()=>{let u=i.value;return i=t.next(),!i.done&&u==="b"&&(u+=i.value,i=t.next()),u.length===1?"w"+u:u},c=u=>/[-\d]/.test(u);for(;!i.done;)i.value===K?(n=a(!0),r[n]={}):i.value===de?(o=a(!0),r[n][o]=[]):c(i.value)?(o=a(),r[n][o]=[]):r[n][o].push(s());return r}function Bn(e){function t(a){if(a[0]==="("){let s=a.slice(1,-1).split(",");return{q:parseInt(s[0]),r:parseInt(s[1])}}if(a[0]==="[")return a.slice(1,-1);throw new Error(`Invalid token: ${a}`)}let r=[],n=[],o="",i="";for(let a=0,s=e.length;a<s;++a){let c=e[a];if(c==="#")break;if(c==="x"){r.push({pass:!0});continue}if(o+=c,i+=c,(c===")"||c==="]")&&(n.push(i),i=""),n.length===2){let u=t(n[0]),f=t(n[1]);typeof f=="string"?r.push({tileId:f,to:u}):r.push({from:u,to:f}),n=[],o=""}}return r}function ht(){return"x"}function xt(e,t){return`(${t.q},${t.r})[${e}]`}function Mn(e,t,r){let n=[];for(let s=0;s<6;++s){let c=2*we*s/6;n.push({x:e*Math.cos(c),y:e*Math.sin(c)})}if(t===0)return[We(n[5],r),...n.map(s=>Je(s,r))].join(" ")+"z";let o=_t(n,t/2),i=yt(o);return vt(i,r).join(" ")+"z"}function We(e,t){return`M${e.x.toFixed(t)} ${e.y.toFixed(t)}`}function Je(e,t){return`L${e.x.toFixed(t)} ${e.y.toFixed(t)}`}function gt(e,t,r){return`Q ${e.x.toFixed(r)} ${e.y.toFixed(r)}, ${t.x.toFixed(r)} ${t.y.toFixed(r)}`}function Ct(e,t){let r=e[0],n=e[1],o=n.x-r.x,i=n.y-r.y,a=Math.hypot(o,i);return[{x:r.x+t*o/a,y:r.y+t*i/a},{x:n.x-t*o/a,y:n.y-t*i/a}]}function _t(e,t){let r=e.map((i,a)=>{let s=a===e.length-1?e[0]:e[a+1];return[i,...Ct([i,s],t)]}),n=r[0];return[r[r.length-1],...r,n]}function yt(e){let t=null,r=[];return e.forEach(([n,o,i])=>{t&&r.push([t,n,o]),t=i}),r}function vt(e,t){let r=[],n=e.length-1;return e.forEach(([o,i,a],s)=>{s===0?r.push(We(o,t)):r.push(Je(o,t)),s!==n&&r.push(gt(i,a,t))}),r}})();
